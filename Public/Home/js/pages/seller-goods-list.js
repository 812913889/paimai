/*!
 * M.YS.COM v0.0.0
 * Copyright 2015
 * Author burning <iburning@live.cn>
 */
function onsale(a,b){utils.ajax({url:_onsaleApi,data:{productId:a},success:function(a){"function"==typeof b&&b(a)},error:function(a){utils.hideMask(),utils.showAlert({content:a.status+" - "+a.statusText})}})}function offsale(a,b){utils.ajax({url:_offsaleApi,data:{productId:a},success:function(a){1===a.resultCode?"function"==typeof b&&b(a):utils.showAlert({content:a.resultMessage})},error:function(a){utils.hideMask(),utils.showAlert({content:a.status+" - "+a.statusText})}})}function delGoods(a,b){utils.ajax({url:_delApi,data:{productId:a},success:function(a){1===a.resultCode?"function"==typeof b&&b(a):utils.showAlert({content:a.resultMessage})},error:function(a){utils.hideMask(),utils.showAlert({content:a.status+" - "+a.statusText})}})}$(function(){var a=$("#loading"),b=$("#no-item"),c=new CIScrollLoad({wrap:$(window),content:$(document),lead:100,loadApi:_listApi,loadType:"post",loadData:{page:_page++},beforeLoad:function(){a.css("display","")},afterLoad:function(d){d.error?utils.showAlert({title:"提示",content:d.message}):(1!==_page||d.value||b.css("display",""),a.fadeOut(),_listMoreHandler(d.value),d.value.isNextPage?c.loadData={page:_page++}:c.isEnd=!0)}});c.load(),$list=$("#item-list"),$list.delegate(".onsale","click",function(a){if(a.stopPropagation(),a.preventDefault(),!$(this).hasClass("disabled")){var b=$(this).data("id");onsale(b,function(a){if(1===a.resultCode){utils.showAlert({content:a.resultMessage});var c=$("#item-"+b);c.fadeOut(function(){c.remove()})}else a.goUrl?utils.showAlert({content:a.resultMessage,onButtonClick:function(){utils.goUrl(a.goUrl)}}):utils.showAlert({content:a.resultMessage})})}}),$list.delegate(".offsale","click",function(a){if(a.stopPropagation(),a.preventDefault(),!$(this).hasClass("disabled")){var b=$(this).data("id");utils.showConfirm({content:"是否下架？",onConfirm:function(){offsale(b,function(a){var c=$("#item-"+b);c.fadeOut(function(){c.remove()})})}})}}),$list.delegate(".del","click",function(a){if(a.stopPropagation(),a.preventDefault(),!$(this).hasClass("disabled")){var b=$(this).data("id");utils.showConfirm({content:"是否删除？",onConfirm:function(){delGoods(b,function(a){var c=$("#item-"+b);c.fadeOut(function(){c.remove()})})}})}})});