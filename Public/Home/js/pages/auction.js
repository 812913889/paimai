/*!
 * M.YS.COM v0.0.0
 * Copyright 2015
 * Author burning <iburning@live.cn>
 */
function onAuctionHandler(a){1===a.resultCode&&utils.showAlert({content:a.resultMessage})}function initAuctionList(a,b){b=b||10,utils.ajax({url:_auctionListApi,type:"post",data:{productId:_productId,sinceId:a,limit:b},success:function(b){if(1===b.resultCode){var c=parseInt(b.value.info.currentPrice)||0,d=parseInt(b.value.info.bidPrice)||0;$currentPrice.html(c),auction&&(auction.minPrice=d,auction.isEditedByUser||auction.setPrice(d)),$auctionCount.html(b.value.totalCount),$moreAuctionButton.data("last-id",b.value.info.lastId||0),b.value.htmlString&&(0===a&&$auctionList.html(""),$auctionList.append(b.value.htmlString))}},error:function(a){console.error(a.status+" - "+a.statusText)}})}function showWechatNumber(a,b){a&&$.ajax({url:"/goods/wechatnumber",method:"post",data:{productId:a},success:function(a){if(1===a.resultCode){var c=a.value.info;c&&(console.log(c,b.length),b.css("display","").html("[微信号 "+c+"]"))}}})}var auction=null,$auctionCount=null,$auctionList=null,$moreAuctionButton=null,$currentPrice=null;$(function(){$currentPrice=$("#current-price");var a=$("#auction");a.hasClass("disable")?a.on("click",function(a){a.stopPropagation()}):auction=new Auction({el:$("#auction"),productId:_productId,auctionApi:_auctionApi,auctionStep:_auctionStep,auctionCount:_bidCount,inputValue:_currentPrice,onAuction:window._onAuctionHandler||onAuctionHandler}),$auctionCount=$("#auction-count"),$auctionList=$("#auction-list"),$moreAuctionButton=$("#btn-more-auction"),$moreAuctionButton.on("click",function(a){var b=$moreAuctionButton.data("last-id");initAuctionList(b)}),$("#btn-refresh-auction").on("click",function(a){initAuctionList(0)}),initAuctionList(),_autoRefreshDuration&&(auctionLoop=new Loop({delay:_autoRefreshDuration}),auctionLoop.addAction("refreshAuction",function(a){initAuctionList(0)}),auctionLoop.play()),window._isAutoShowShareTip&&utils.showShareTip()});
